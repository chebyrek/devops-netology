**2. Узнайте о том, сколько действительно независимых (не пересекающихся) каналов есть в разделяемой среде WiFi при работе на 2.4 ГГц. Стандарты с полосой 5 ГГц более актуальны, но регламенты на 5 ГГц существенно различаются в разных странах, а так же не раз обновлялись. В качестве дополнительного вопроса вне зачета, попробуйте найти актуальный ответ и на этот вопрос.**  

3 непересекающихся канала - 1, 6, 11  

**3. Адрес канального уровня – MAC адрес – это 6 байт, первые 3 из которых называются OUI – Organizationally Unique Identifier или уникальный идентификатор организации. Какому производителю принадлежит MAC `38:f9:d3:55:55:79`?**  

38:F9:D3 Apple, Inc.

**4. Каким будет payload TCP сегмента, если Ethernet MTU задан в 9001 байт, размер заголовков IPv4 – 20 байт, а TCP – 32 байта?**  

9001 - 20 - 32 = 8949 байт  

**5. Может ли во флагах TCP одновременно быть установлены флаги SYN и FIN при штатном режиме работы сети? Почему да или нет?**

нет, такая комбинация флагов считается недопустимой. Флаг SYN нужен для установки соединения, а FIN для его завершения. Очевидно, что одновременное их использование лишено всякого смысла.  

**6. `ss -ula sport = :53` на хосте имеет следующий вывод:**
```
State           Recv-Q          Send-Q                   Local Address:Port                     Peer Address:Port          Process
UNCONN          0               0                        127.0.0.53%lo:domain                        0.0.0.0:*
```
**Почему в `State` присутствует только `UNCONN`, и может ли там присутствовать, например, `TIME-WAIT`?**  

Команда выводит на экран только udp соединиения, а протокол udp не поддерживает состояний (stateless), а значит никаких других значений в колонке `State` быть не может  

**7. Обладая знаниями о том, как штатным образом завершается соединение (FIN от инициатора, FIN-ACK от ответчика, ACK от инициатора), опишите в каких состояниях будет находиться TCP соединение в каждый момент времени на клиенте и на сервере при завершении. Схема переходов состояния соединения вам в этом поможет.**  

![Connection state diagram](/homework/img/Close_con_state.png)  

**8. TCP порт – 16 битное число. Предположим, 2 находящихся в одной сети хоста устанавливают между собой соединения. Каким будет теоретическое максимальное число соединений, ограниченное только лишь параметрами L4, которое параллельно может установить клиент с одного IP адреса к серверу с одним IP адресом? Сколько соединений сможет обслужить сервер от одного клиента? А если клиентов больше одного?**  

теоретическое максимальное число соединений 2<sup>16</sup> = 65536  
Количество соединений от одного клиента ограничено количеством портов на клиенте (65536), а от нескольких клиентов ограничего только ресурсами сервера (теоретически бесконечно).   

**9. Может ли сложиться ситуация, при которой большое число соединений TCP на хосте находятся в состоянии `TIME-WAIT`? Если да, то является ли она хорошей или плохой? Подкрепите свой ответ пояснением той или иной оценки.**  

Может, такая ситуация является плохой. Допустим, клиент часто подключается/отключается к какому-то серверу, а значит появляется множество соединений в состоянии TIME_WAIT, такие соединения сами закрываются через определенное время, но при активном подключении/отключении соединения в TIME_WAIT могут не успевать закрываться и клиент исчерпает максимальное количество доступных ему подключений.  

**10. Чем особенно плоха фрагментация UDP относительно фрагментации TCP?**  

TCP-заголовок содержит поле sequence number, что позволяет без проблем восстановить последовательность полученных данных.  

**11. Если бы вы строили систему удаленного сбора логов, то есть систему, в которой несколько хостов отправяют на центральный узел генерируемые приложениями логи (предположим, что логи – текстовая информация), какой протокол транспортного уровня вы выбрали бы и почему? Проверьте ваше предположение самостоятельно, узнав о стандартном протоколе syslog.**  

Кажется, что лучше использовать TCP для гарантированной доставки сообщений, но при большой нагрузке на сервер предпочтительнее будет UDP для увеличения быстродействия. По умолчанию syslog использует UPD, хотя, как я понял, никто не запрещает поменять на TCP, лишь бы была поддержка на клиентах.  

**12. Сколько портов TCP находится в состоянии прослушивания на вашей виртуальной машине с Ubuntu, и каким процессам они принадлежат?**  

```
sudo ss -ltH | wc -l
6
```
```
sudo ss -ltpH | awk '{print $1,$6}'
LISTEN users:(("netdata",pid=2350,fd=16))
LISTEN users:(("netdata",pid=2350,fd=4))
LISTEN users:(("systemd-resolve",pid=1078956,fd=13))
LISTEN users:(("sshd",pid=686,fd=3))
LISTEN users:(("node_exporter",pid=644,fd=3))
LISTEN users:(("sshd",pid=686,fd=4))
```
**13. Какой ключ нужно добавить в tcpdump, чтобы он начал выводить не только заголовки, но и содержимое фреймов в текстовом виде? А в текстовом и шестнадцатиричном?**  
```
tcpdump -A
```
```
tcpdump -X
```

**14. Попробуйте собрать дамп трафика с помощью `tcpdump` на основном интерфейсе вашей виртуальной машины и посмотреть его через `tshark` или `Wireshark` (можно ограничить число пакетов `-c 100`). Встретились ли вам какие-то установленные флаги Internet Protocol (не флаги TCP, а флаги IP)? Узнайте, какие флаги бывают. Как на самом деле называется стандарт Ethernet, фреймы которого попали в ваш дамп? Можно ли где-то в дампе увидеть OUI?**

```
sudo tcpdump -i eth0 -c 100 -w tdump
tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size 262144 bytes
100 packets captured
103 packets received by filter
0 packets dropped by kernel
```
В некоторых пакетах установлен флаг "Don't fragment"  
Бывают флаги:  
0: Зарезервирован, должен быть равен 0.[13]  
1: Не фрагментировать  
2: У пакета ещё есть фрагменты  

Стандарт называется Ethernet II  
Wireshark заменяет первые 3 байта MAC-адреса отправителя и получателя на наименование производителя  




